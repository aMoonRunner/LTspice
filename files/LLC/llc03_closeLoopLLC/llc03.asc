Version 4.1
SHEET 1 3076 3708
WIRE -400 368 -1264 368
WIRE 64 368 -192 368
WIRE 208 368 160 368
WIRE -400 400 -832 400
WIRE 160 400 160 368
WIRE 160 400 -192 400
WIRE -1264 432 -1264 368
WIRE -832 432 -832 400
WIRE -400 432 -688 432
WIRE -32 432 -192 432
WIRE -688 464 -688 432
WIRE -400 464 -544 464
WIRE -96 464 -192 464
WIRE -544 496 -544 464
WIRE -2272 544 -2336 544
WIRE -2112 544 -2272 544
WIRE -832 560 -832 512
WIRE -32 576 -32 432
WIRE 64 576 -32 576
WIRE 208 576 160 576
WIRE -688 592 -688 544
WIRE -2112 608 -2112 544
WIRE -96 608 -96 464
WIRE 160 608 160 576
WIRE 160 608 -96 608
WIRE -544 624 -544 576
WIRE -1760 656 -1904 656
WIRE -1536 656 -1696 656
WIRE -2272 688 -2272 544
WIRE -2112 752 -2112 672
WIRE -1904 768 -1904 656
WIRE -1840 768 -1904 768
WIRE -1680 768 -1776 768
WIRE -1536 768 -1536 656
WIRE -1536 768 -1600 768
WIRE -912 864 -976 864
WIRE -624 864 -912 864
WIRE 288 864 -624 864
WIRE -2272 896 -2272 768
WIRE -2112 896 -2112 832
WIRE -2112 896 -2272 896
WIRE -1904 896 -1904 768
WIRE -1904 896 -2112 896
WIRE -1856 896 -1904 896
WIRE -1632 912 -1792 912
WIRE -1536 912 -1536 768
WIRE -1536 912 -1632 912
WIRE -1440 912 -1536 912
WIRE -624 912 -624 864
WIRE -624 912 -720 912
WIRE -560 912 -624 912
WIRE -1856 928 -1904 928
WIRE -1632 944 -1632 912
WIRE -1536 944 -1536 912
WIRE -720 944 -720 912
WIRE -624 944 -624 912
WIRE -2272 960 -2272 896
WIRE -560 960 -560 912
WIRE 288 960 288 864
WIRE -1904 976 -1904 928
WIRE -976 992 -976 864
WIRE -720 1040 -720 1024
WIRE -624 1040 -624 1008
WIRE -624 1040 -720 1040
WIRE -560 1040 -560 1024
WIRE -560 1040 -624 1040
WIRE -1632 1056 -1632 1008
WIRE -1536 1056 -1536 1008
WIRE -2272 1088 -2272 1040
WIRE -1904 1088 -1904 1056
WIRE -624 1104 -624 1040
WIRE -560 1104 -624 1104
WIRE -400 1104 -560 1104
WIRE -144 1104 -320 1104
WIRE -64 1104 -144 1104
WIRE 96 1104 16 1104
WIRE 288 1104 288 1024
WIRE 288 1104 96 1104
WIRE -624 1168 -624 1104
WIRE -624 1168 -720 1168
WIRE -544 1168 -624 1168
WIRE -976 1184 -976 1072
WIRE -720 1200 -720 1168
WIRE -624 1216 -624 1168
WIRE -544 1216 -544 1168
WIRE 288 1216 288 1104
WIRE -144 1232 -144 1104
WIRE -80 1232 -144 1232
WIRE 96 1232 96 1104
WIRE 96 1232 0 1232
WIRE -720 1312 -720 1280
WIRE -624 1312 -624 1280
WIRE -624 1312 -720 1312
WIRE -544 1312 -544 1280
WIRE -544 1312 -624 1312
WIRE 288 1360 288 1280
WIRE -624 1376 -624 1312
WIRE -400 1488 -624 1488
WIRE -128 1488 -320 1488
WIRE 80 1488 -128 1488
WIRE 288 1488 160 1488
WIRE -624 1568 -624 1488
WIRE -624 1568 -720 1568
WIRE -544 1568 -624 1568
WIRE 288 1568 288 1488
WIRE 288 1568 192 1568
WIRE 400 1568 288 1568
WIRE -720 1600 -720 1568
WIRE 192 1600 192 1568
WIRE -624 1616 -624 1568
WIRE -544 1616 -544 1568
WIRE 288 1616 288 1568
WIRE 400 1616 400 1568
WIRE -720 1712 -720 1680
WIRE -624 1712 -624 1680
WIRE -624 1712 -720 1712
WIRE -544 1712 -544 1680
WIRE -544 1712 -624 1712
WIRE 192 1712 192 1680
WIRE 288 1712 288 1680
WIRE 288 1712 192 1712
WIRE 400 1712 400 1680
WIRE 400 1712 288 1712
WIRE 288 1728 288 1712
WIRE -624 1744 -624 1712
WIRE -128 1808 -128 1488
WIRE 64 1808 -128 1808
WIRE 192 1808 64 1808
WIRE 288 1808 192 1808
WIRE 432 1808 368 1808
WIRE 464 1808 432 1808
WIRE 592 1808 544 1808
WIRE 720 1808 672 1808
WIRE 816 1808 800 1808
WIRE 960 1808 816 1808
WIRE -128 1888 -128 1808
WIRE 64 1888 64 1808
WIRE 192 1888 192 1808
WIRE 432 1888 432 1808
WIRE 816 1888 816 1808
WIRE 64 1968 64 1952
WIRE 192 1968 192 1952
WIRE 432 1968 432 1952
WIRE -128 2064 -128 1968
WIRE 64 2064 64 2048
WIRE 192 2064 192 2048
WIRE 432 2064 432 2048
WIRE 816 2064 816 1968
FLAG -624 1376 0
FLAG 64 2064 0
FLAG -128 2064 0
FLAG -560 1104 a
FLAG -976 1184 0
FLAG 288 1728 0
FLAG -624 1744 0
FLAG 432 1808 vout
FLAG -912 864 vin
FLAG 288 1488 c
FLAG -624 1488 d
FLAG 288 1360 0
FLAG -768 1008 0
FLAG -768 960 g1
FLAG -768 1264 0
FLAG -768 1216 g2
FLAG 288 1104 b
FLAG 192 2064 0
FLAG 432 2064 0
FLAG 64 1808 e
FLAG 816 2064 0
FLAG -832 560 0
FLAG -688 592 0
FLAG -544 624 0
FLAG 112 352 g1
FLAG 112 432 0
FLAG 64 416 0
FLAG 256 352 g2
FLAG 256 432 0
FLAG 208 416 0
FLAG 112 560 gsr1
FLAG 112 640 0
FLAG 64 624 0
FLAG 256 560 gsr2
FLAG 256 640 0
FLAG 208 624 0
FLAG -768 1664 0
FLAG 144 1664 0
FLAG -2272 1088 0
FLAG -1904 1088 0
FLAG -2336 544 vout
FLAG -1440 912 type3out
FLAG -1264 512 0
FLAG -1632 1136 0
FLAG -1536 1136 0
FLAG 960 1968 0
FLAG -768 1616 0
FLAG 144 1616 0
SYMBOL diode -608 1008 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D1
SYMATTR Value userD
SYMBOL cap 48 1888 R0
WINDOW 3 24 44 Left 2
SYMATTR Value 630u
SYMATTR InstName C1
SYMBOL res -144 1872 R0
SYMATTR InstName R1
SYMATTR Value 1000
SYMBOL voltage -976 976 R0
SYMATTR InstName V4
SYMATTR Value 400
SYMBOL diode -608 1280 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D2
SYMATTR Value userD
SYMBOL ind -416 1120 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {Lr}
SYMATTR SpiceLine Rser=1m
SYMBOL cap 272 960 R0
SYMATTR InstName C5
SYMATTR Value {Cr/2}
SYMBOL ind2 32 1088 R90
WINDOW 0 4 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value {Lm}
SYMATTR Type ind
SYMBOL ind2 64 1504 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName T2
SYMATTR Value 10m
SYMATTR SpiceLine Rser=1m
SYMATTR Type ind
SYMBOL ind2 -416 1504 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName T3
SYMATTR Value 10m
SYMATTR SpiceLine Rser=1m
SYMATTR Type ind
SYMBOL diode 304 1680 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D5
SYMATTR Value userD
SYMBOL diode -608 1680 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D6
SYMATTR Value userD
SYMBOL ind2 16 1216 R90
WINDOW 0 4 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName T1
SYMATTR Value {10m*n**2}
SYMATTR Type ind
SYMBOL cap 272 1216 R0
SYMATTR InstName C4
SYMATTR Value {Cr/2}
SYMBOL sw -720 1040 M180
WINDOW 3 24 -20 Invisible 2
SYMATTR InstName S1
SYMBOL ind 272 1824 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value 150n
SYMBOL current 816 1888 R0
WINDOW 3 24 152 Left 2
WINDOW 39 24 116 Left 2
WINDOW 123 0 0 Left 0
SYMATTR Value PWL(0 10 6m 10 {6m+10u} 18 12m 18 {12m+10u} 1 18m 1 {18m+10u} 18)
SYMATTR SpiceLine load
SYMATTR InstName I2
SYMBOL res 416 1952 R0
SYMATTR InstName R10
SYMATTR Value 0.02
SYMBOL res 176 1952 R0
SYMATTR InstName R11
SYMATTR Value 0.02
SYMBOL res 48 1952 R0
SYMATTR InstName R12
SYMATTR Value 0.02
SYMBOL cap -576 960 R0
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL sw -720 1296 M180
WINDOW 3 24 -20 Invisible 2
SYMATTR InstName S2
SYMBOL cap -560 1216 R0
SYMATTR InstName C2
SYMATTR Value 100p
SYMBOL cap -560 1616 R0
SYMATTR InstName C6
SYMATTR Value 100p
SYMBOL cap 384 1616 R0
SYMATTR InstName C7
SYMATTR Value 100p
SYMBOL cap 176 1888 R0
WINDOW 3 24 44 Left 2
SYMATTR Value 630u
SYMATTR InstName C8
SYMBOL cap 416 1888 R0
WINDOW 3 24 44 Left 2
SYMATTR Value 630u
SYMATTR InstName C9
SYMBOL userLib_pfm -320 416 R0
SYMATTR InstName U1
SYMBOL voltage -832 416 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 200n
SYMBOL voltage -688 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 200n
SYMBOL voltage -544 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 500n
SYMBOL e 112 336 R0
SYMATTR InstName E1
SYMATTR Value 12
SYMBOL e 256 336 R0
SYMATTR InstName E2
SYMATTR Value 12
SYMBOL e 112 544 R0
SYMATTR InstName E3
SYMATTR Value 12
SYMBOL e 256 544 R0
SYMATTR InstName E4
SYMATTR Value 12
SYMBOL sw -720 1696 M180
WINDOW 3 24 -20 Invisible 2
SYMATTR InstName S3
SYMBOL sw 192 1696 M180
WINDOW 3 24 -20 Invisible 2
SYMATTR InstName S4
SYMBOL voltage -1904 960 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 2.5
SYMBOL res -2288 944 R0
SYMATTR InstName R2
SYMATTR Value 490
SYMBOL res -2288 672 R0
SYMATTR InstName R3
SYMATTR Value {Rupper}
SYMBOL cap -1776 752 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value {C1}
SYMBOL res -1584 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {R2}
SYMBOL cap -1696 640 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value {C2}
SYMBOL res -2128 736 R0
SYMATTR InstName R5
SYMATTR Value {R3}
SYMBOL cap -2128 608 R0
SYMATTR InstName C12
SYMATTR Value {C3}
SYMBOL bv -1264 416 R0
SYMATTR InstName B1
SYMATTR Value V=100-v(type3out)
SYMBOL diode -1616 1008 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL voltage -1632 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value -100
SYMBOL OpAmps\\opamp -1824 848 R0
SYMATTR InstName U2
SYMBOL diode -1552 944 R0
SYMATTR InstName D4
SYMBOL voltage -1536 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 40
SYMBOL current 960 1888 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 116 Left 2
SYMATTR SpiceLine load
SYMATTR InstName I1
SYMATTR Value 18
SYMBOL ind 576 1824 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 150n
SYMBOL res 816 1792 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 0.1
SYMBOL res 560 1792 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 0.02
TEXT -1192 1920 Left 2 !.param simTime=20m\n.param dataTime=2m\n \n.param Lm=200u Lr=20u Cr=164n n=3.75
TEXT -1184 1848 Left 2 !.tran 0 {simTime} {dataTime} uic
TEXT -216 1368 Left 2 !k T1 T2 T3 1
TEXT -1192 2296 Left 2 !.options gmin=1e-10\n.options abstol=1e-10\n.options reltol=0.003\n.options method=gear\n.options cshunt=1e-12\n.options gshunt=1e-9\n \n.model SW SW(Ron=1m Roff=1Meg Vt=5 Vh=0)\n.model userD D(Ron=1m Roff=1Meg Vfwd=0.5)
TEXT -144 2176 Left 2 !.ic v(nodeE)=53.5V V(vout)=53.5V
TEXT -3496 464 Left 2 !.lib opamp.sub\n.param Rupper=10k\n.param fc=5k\n.param Gfc=20 G=10**(Gfc/20)\n.param boost=145\n.param fp=fc/(tan((45-(boost/4))*pi/180))\n.param fz=fc**2/fp\n.param fz1=fz*0.75 fz2=fz*1.25\n.param fp1=fp*0.75 fp2=fp*1.25\n \n \n.param a=sqrt(1+(fc/fp1)**2)\n.param b=sqrt(1+(fc/fp2)**2)\n.param c=sqrt(1+(fz1/fc)**2)\n.param d=sqrt(1+(fc/fz2)**2)\n.param R2=Rupper*G*fp1*(((a*b)/(c*d))/(fp1-fz1))\n \n.param C1=1/(2*pi*fz1*R2)\n.param C2=C1/(C1*R2*2*pi*fp2-1)\n.param C3=(fp2-fz2)/(2*pi*Rupper*fp2*fz2)\n.param R3=Rupper*fz2/(fp2-fz2)
